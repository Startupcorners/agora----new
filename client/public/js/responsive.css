/* Video stage layout and responsiveness */
.video-stage {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    /* Responsive columns */
    justify-content: center;
    gap: 10px;
    /* Space between each participant */
    width: 100%;
    height: 100%;
    padding: 10px;
    box-sizing: border-box;
}

/* When there's only 1 participant, center and limit max width */
.video-stage.child-count-1 {
    max-width: 800px;
    /* Limit max width of video stage */
    margin: 0 auto;
    /* Center video stage on screen */
}

.video-stage.child-count-1>div {
    max-width: 100%;
    /* Allow child to take full width within 800px limit */
}

/* For 2 participants, display side by side */
.video-stage.child-count-2 {
    grid-template-columns: repeat(2, 1fr);
    /* Two equal columns */
}

/* For 3-4 participants, use a two-by-two grid with max width */
.video-stage.child-count-3,
.video-stage.child-count-4 {
    grid-template-columns: 1fr 1fr;
    /* Two columns */
    grid-template-rows: repeat(2, 1fr);
    /* Two rows */
    max-width: 800px;
    /* Limit max width */
    margin: 0 auto;
    /* Center video stage */
}

/* For 5+ participants, use a grid with auto-fit columns */
.video-stage.child-count-5,
.video-stage.child-count-6,
.video-stage.child-count-7,
.video-stage.child-count-8,
.video-stage.child-count-9 {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    /* Fit as many as possible per row */
    grid-auto-rows: minmax(100px, auto);
    /* Allow flexible height */
}

/* Responsive behavior for different screen sizes */

/* Default media queries when #right is NOT visible */
@media (max-width: 600px) {

    /* 1 child: Full width and height */
    .video-stage.child-count-1>div {
        width: 100%;
        height: 100%;
    }

    /* 2 children: 1 column, 2 rows */
    .video-stage.child-count-2 {
        grid-template-columns: 1fr;
        grid-template-rows: 1fr 1fr;
    }

    /* 3 or 4 children: 2 columns, 2 rows */
    .video-stage.child-count-3,
    .video-stage.child-count-4 {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        max-width: 800px;
        /* Maintain max width */
        margin: 0 auto;
        /* Center video stage */
    }

    /* More than 4 children: 2 columns, multiple rows; row height min 250px */
    .video-stage.child-count-5,
    .video-stage.child-count-6,
    .video-stage.child-count-7,
    .video-stage.child-count-8,
    .video-stage.child-count-9 {
        grid-template-columns: 1fr 1fr;
        grid-auto-rows: minmax(250px, auto);
    }
}

@media (min-width: 601px) and (max-width: 900px) {

    .video-stage.child-count-3,
    .video-stage.child-count-4 {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        max-width: 800px;
        /* Maintain max width */
        margin: 0 auto;
        /* Center video stage */
    }

    .video-stage.child-count-5,
    .video-stage.child-count-6,
    .video-stage.child-count-7,
    .video-stage.child-count-8,
    .video-stage.child-count-9 {
        grid-template-columns: 1fr 1fr 1fr;
    }
}

@media (min-width: 901px) {

    .video-stage.child-count-3,
    .video-stage.child-count-4 {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        max-width: 800px;
        /* Maintain max width */
        margin: 0 auto;
        /* Center video stage */
    }

    .video-stage.child-count-5,
    .video-stage.child-count-6,
    .video-stage.child-count-7,
    .video-stage.child-count-8,
    .video-stage.child-count-9 {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
}

/* Adjusted media queries when #right IS visible, adding 350px to each breakpoint */
@media (max-width: 950px) {

    .right-visible .video-stage.child-count-3,
    .right-visible .video-stage.child-count-4 {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        max-width: 800px;
        /* Maintain max width */
        margin: 0 auto;
        /* Center video stage */
    }
}

@media (min-width: 951px) and (max-width: 1250px) {

    .right-visible .video-stage.child-count-3,
    .right-visible .video-stage.child-count-4 {
        grid-template-columns: 1fr 1fr;
        grid-template-rows: 1fr 1fr;
        max-width: 800px;
        /* Maintain max width */
        margin: 0 auto;
        /* Center video stage */
    }
}

@media (min-width: 1251px) {

    .right-visible .video-stage.child-count-5,
    .right-visible .video-stage.child-count-6,
    .right-visible .video-stage.child-count-7,
    .right-visible .video-stage.child-count-8,
    .right-visible .video-stage.child-count-9 {
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    }
}